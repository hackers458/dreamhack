# 🧩 Reverse Engineering Challenge: instrs

## 📖 문제 개요
- **문제 이름**: instrs 
- **출처**: 드림핵  
- **키워드**: 난해한 프로그래밍 언어(ex:brainfuck) , 가상환경
- **설명**: 가상환경에 설정된 명령어를 이용하여 조건을 만족시키기

---

## 🛠️ 사용 도구
- **IDA**: 정적 분석   
- **vscode**: 코드 작성  

---

## 🚀 풀이 방법
- 풀이 방법이 2가지가 있다. 하나는 브루트포스로 구하기(경우의 수가 적어 구할 수 있다.), 다른 하나는 직접 명령어를 생각하며 조합하기

---

## 📁 파일 구성
- **prob** : 문자열을 입력하면 입력한 문자에 맞춰 작동하는 프로그 

---

## 🔍 파일 동작 원리

| 단계 | 이미지 | 설명 |
|------|--------|------|
| 1단계 |  <img width="286" height="883" alt="화면 캡처 2026-02-02 034419" src="https://github.com/user-attachments/assets/16ab4768-04ec-4036-8887-b5e5b9f05664" />| 내가 입력한 문자열 길이 = 8
저장소 = [0,0,0,0.,0,0,0,0] = 길이 8
쓸수 있는 문자 = a e l n r + -
처음 시작하면 j = 0으로 시작,


i = 합계
j = 종료 확인 여부 플래그
내가 입력한 인덱스 = my_index
저장소의 인덱스 = data_index

a를 입력했을때
	-> 만약 저장소 값이 0이면 my_index를 1 증가 시키고 my_index의 값이 7이 넘쳤는지 확인한다. 넘쳤으면 7로 만든다.
     	저장소 값이 0이 아니면 my_index를 0으로 저장
e를 입력했을때
	-> 종료를 한다. 즉 i를 반환
l 를 입력했을때
 	 data_index를 감소 시키고 data_index가 음수면 data_index를 0으로 만들고  my_index를 1 증가 시키고  my_index의 값이 7이 넘쳤는지 확인한다. 넘쳤으면 7로 만든다.
n를 입력했을때
	 my_index를 1 증가 시키고  my_index의 값이 7이 넘쳤는지 확인한다. 넘쳤으면 7로 만든다.
r를 입력했을때
	data_index를 증가시키고 만약 data_index가 7보다 크면 7로 만들고  my_index를 1 증가 시키고 my_index의 값이 7이 넘쳤는지 확인한다. 넘쳤으면 7로 만든다.

+ 입력하면 저장소 값 증가, my_index를 1 증가 시키고 my_index의 값이 7이 넘쳤는지 확인한다. 넘쳤으면 7로 만든다.
- 를 입력하면 저장소 값 감소, my_index를 1 증가 시키고 my_index의 값이 7이 넘쳤는지 확인한다. 넘쳤으면 7로 만든다. |
**이 부분만 중요하고 나머지 main 함수는 간단 요약하면 위의 단계의 반환값이 9999보다 커야한다. 그리고 5초안에 결과값이 나와야 한다 정도**

---

## 🧠 접근 방법
- `dword_4020`은 4바이트 값들의 배열이다.  

| 이미지 | 설명 |
| --- | --- |
| <img width="1066" height="66" alt="파이썬 구현" src="https://github.com/user-attachments/assets/e2c6b95e-afbb-47e7-b555-d9e9026814f8" /> | 해당 동작을 그대로 **파이썬**에 구현하여 더 빠른 `sort()` 함수를 사용한 뒤 `sha256`으로 암호화한 값이 곧 플래그이다. 단, 파이썬에서는 4바이트가 넘칠 수 있으므로 `0xffffffff`로 AND 연산을 해줘야 한다. |

---

## 😪 막힌 부분
- 처음에 `0xhex_dc`의 값인 줄 알고 `0xdc`를 전달하는 줄 알았다가, 사실은 **주소값**을 전달하는 것이어서 시간을 좀 애먹었다.  
- OR 연산의 리턴값을 `0xffffffff`로 AND 연산해줘야 하는데 계속 잊어서 플래그가 틀렸다. → 꼭 기억해야 한다.  

---

## 📚 공부한 내용
- **Stooge Sort** 정렬 알고리즘을 새롭게 알게 되었다.  

---

## 📗 비고
- 정렬 문제라는 건 보자마자 알았다.  
- 백준 문제를 풀다 보면 특정 조건(`lambda`)을 두고 정렬하는 경우가 많아, 그 경험 덕분에 접근이 조금 더 수월했다.  
