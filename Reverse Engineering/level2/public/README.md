# 🧩 Reverse Engineering Challenge: `public`

## 📖 문제 개요

- 문제 이름: `public`
- 출처 : 드림핵
- 키워드 : RSA
- 설명: RSA의 원리를 이해하고 암호화된 값을 공개키와 개인키를 구하여 복호화 하는 문제.

------------------------------------------------------------------------------------
🛠️ 사용 도구
• 	IDA / Ghidra: 정적 분석
• 	gdb / pwndbg: 동적 분석
• 	Python: 입력값 계산
------------------------------------------------------------------------------------
🚀 풀이 방법

- 분석을 통해 도출한 입력값:
•	입력값을 넣으면 "Access Granted!" 메시지가 출력됨
------------------------------------------------------------------------------------
📁 파일 구성

public : 문제 파일(.elf)
out.txt(n1,n2의 값)
out.bin(결과물)
------------------------------------------------------------------------------------
파일 동작 원리?
<img width="678" height="648" alt="화면 캡처 2025-10-28 013102" src="https://github.com/user-attachments/assets/b9a0760a-06b6-4cd0-9064-3fb9188f23da" />
out.txt에는
n1 = 4271010253
n2 = 201326609
이렇게 돼있다. 즉 n1은 p x q로 이루어져 있다. 이걸 어떻게 찾는가?
다행히도 파이썬에는 소수인지 아닌지 확인해주는 라이브러리 함수 isprime이 있다.
이를 이용하여 구하면 65287 65419 = p , q를 구할 수 있다.
그럼 e는 어떻게 구할까? 이미 n2의 출력값이 곧 e의 값이다. 그러므로 저게 e값이다.

<img width="625" height="379" alt="화면 캡처 2025-10-28 021031" src="https://github.com/user-attachments/assets/72a2fc6c-dcda-4adb-92b7-b6b94e0c07b6" />
여기서 보면 위에 다 필요없고 빨간줄이 가장 중요한데, flag.txt를 만들어서 내가 abcd를 입력하면 64636261로 리틀 엔디언으로 저장이 되어 RSA로 암호화된 뒤 8바이트로 저장이 된다.
40 E1 DC D4 00 00 00 00 -> D4DCE140 
E2 DF 83 A1 00 00 00 00  -> A183DFE2
06 E3 63 C3 00 00 00 00  -> C363E306
68 E2 D2 F9 00 00 00 00 -> F9D2E268
09 24 1A C4 00 00 00 00  -> C41A2409
FB C0 9B 2A 00 00 00 00 -> 2A9BC0FB
B5 22 4E 9A 00 00 00 00 -> 9A4E22B5
9A EF 38 7D 00 00 00 00 ->7D383EF9A
9F 92 5F B1 00 00 00 00 -> B15F929F
EF 7B D6 9E 00 00 00 00 -> 9ED67BEF
E7 EA CD 99 00 00 00 00 -> 99CDEAE7
이게 out.bin인데 오른쪽을 빅 엔디언으로 바꾼 뒤 저걸 복호화 해주면 된다.
개인 키가 필요 하므로 코드에 작성했으니 여기서 설명을 안하겠다.

---------------------------------------------------------------------------------------
- 공부한 부분
- RSA알고리즘에 대해 알게 되었다.(모르고 있었을때는 이상한 문제인줄 알았다.. 드림핵 댓글 == 힌트)
- Ghidra에서 함수보는게 편할때가 있고 IDA에서 보는게 편할 때도 있다. 이거 잘 참고해야겠다.
- 각 짜잘한 함수들이 무슨 역할을 하는지 알아야 한다.
  + Find_PrimeNumber(EqualorBigger) 처럼 풀면서 정리를 잘 해주고 이름을 바꿔놔야지 안햇갈린다. 또한 파라미터를 모를때는 그냥 숫자들 넣어서 그게 무슨역할인지 공부한다.
