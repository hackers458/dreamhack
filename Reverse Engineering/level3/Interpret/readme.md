# 🧩 Reverse Engineering Challenge: Interpret

📖 문제 개요

- 문제 이름: Interpret
- 출처: 드림핵
- 키워드: 가상환경 인터프리터
- 설명: 가상환경 인터프리터

# 🛠️ 사용 도구

- GDB : 동적 분석
- pycharm : 코드 분석

# 🚀 풀이 방법

- 인터프리터의 구조 방식을 이해하고 작동 방식을 역연산 하면 결과가 나오는 프로그램

# 📁 파일 구성

- chall : 인터프리터 프로그
- flag : 정답(로컬인 경우 임시 플래그 값 저장)

# 🔍 파일 동작 원리
<img width="365" height="751" alt="화면 캡처 2026-01-17 155032" src="https://github.com/user-attachments/assets/93b149e9-6494-4012-b42f-c9aaed2ab6c7" />
strtol 함수는 문자열 12를 16진수 0x12로 만드는 함수이다. 즉 문자열 1234567890
0x12 0x34 0x56 0x78 0x90 이렇게 저장이 된다.

<img width="564" height="247" alt="화면 캡처 2026-01-17 181035" src="https://github.com/user-attachments/assets/35f842dd-2e89-49b7-82ce-ac93355268dc" />
해당 데이터는
<img width="542" height="1037" alt="화면 캡처 2026-01-17 025853" src="https://github.com/user-attachments/assets/d6fad439-8778-46c9-935c-532a5e8cf8aa" />
이렇게 저장이 된다. 즉 구조체처럼 저장이 되는 느낌이 있다.

<img width="942" height="887" alt="화면 캡처 2026-01-17 181214" src="https://github.com/user-attachments/assets/01fd08bf-e209-4509-b0ed-9758f234d038" />
이렇게 구조체로 표현을 바꿀 수 있다.
해당 코드는
프로그램에 저장된 데이터를 이용한 인터프리터인데 16진수 값들을 받아들여 각 값에 해당하는 기능들을 수행한다,
01027503b0040505000007e0의 경우 01 02 75 03 b0 04 05 05 000007e0
이렇게 되있는데 01인 경우 내가 입력한 값을 strtol로 갖고와서(인덱스로 갖고온다) 0x12를 갖고오면
그걸 result에 저장하고 02인 경우 result에 + 그 다음 바이트 값인 75를 더한다
03인 경우 다음 값인 b0과 result와 xor 연산
04인 경우 05와 ROL을 05번 수행한다.
마지막으로 05는 저장된 값인 result 값과 7e0과 비교를 한다. 그리고 만약 다르면 0을 반환하여 끝낸다.
# 🧠 접근 방법

각 기능을 담당하는 01 02 03 04 05를 함수 스택에 저장하고 각 함수에 해당하는 연산의 피연산자 값을 데이터 스택에 저장한다. 그리고 05를 만났을때 
반대로 수행을 하면 된다.
가령 01 02 03 04 05를 수행하면 반대로 05 04 03 02 01을 수행하면 result를 구할 수 있으며 각 기능들은 역연산이 가능하기에 그대로 역연산을 하면 된다.

# 📚 공부한 내용

- 인터프리터 및 구조체에 대해서 배웠습니다.
